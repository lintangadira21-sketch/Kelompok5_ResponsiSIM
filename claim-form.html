<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Verifikasi Klaim - RhapsodyFind</title>

    <link
      href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@500&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <style>
      :root {
        /* Palette */
        --midnight: #001f3f;
        --lime: #dbe64c;
        --praxeti: #f6f7ed;
        --slate: #64748b;
      }

      body {
        background: linear-gradient(135deg, #021a33 0%, #1e488f 100%);
        font-family: "Plus Jakarta Sans", sans-serif;
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
        overflow-x: hidden;
      }

      /* --- CARD CONTAINER --- */
      .main-card {
        background: var(--praxeti);
        width: 100%;
        max-width: 1050px;
        border-radius: 24px;
        overflow: hidden;
        display: flex;
        flex-wrap: wrap;
        box-shadow: 0 40px 80px -20px rgba(0, 0, 0, 0.6);
        animation: slideUp 0.8s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
        opacity: 0;
        transform: translateY(30px);
      }

      @keyframes slideUp {
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* --- LEFT PANEL --- */
      .left-panel {
        background: var(--midnight);
        color: white;
        padding: 60px;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        position: relative;
        overflow: hidden;
      }

      .decoration-circle {
        position: absolute;
        top: -100px;
        right: -100px;
        width: 400px;
        height: 400px;
        background: radial-gradient(
          circle,
          rgba(219, 230, 76, 0.15) 0%,
          transparent 70%
        );
        border-radius: 50%;
        pointer-events: none;
      }

      .system-badge {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(5px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 50px;
        padding: 8px 18px;
        font-size: 0.75rem;
        font-weight: 700;
        letter-spacing: 1px;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        color: var(--lime);
        width: fit-content;
      }

      .pulse-dot {
        width: 8px;
        height: 8px;
        background-color: var(--lime);
        border-radius: 50%;
        animation: pulse 2s infinite;
      }
      @keyframes pulse {
        0% {
          box-shadow: 0 0 0 0 rgba(219, 230, 76, 0.7);
        }
        70% {
          box-shadow: 0 0 0 10px rgba(0, 0, 0, 0);
        }
        100% {
          box-shadow: 0 0 0 0 rgba(0, 0, 0, 0);
        }
      }

      .item-title {
        font-size: 3.5rem;
        font-weight: 800;
        line-height: 1.1;
        margin: 30px 0;
        background: linear-gradient(to right, #fff, #cbd5e1);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      .secure-info {
        border-left: 3px solid var(--lime);
        padding-left: 20px;
        color: rgba(255, 255, 255, 0.7);
        font-size: 0.95rem;
      }

      /* --- RIGHT PANEL --- */
      .right-panel {
        background-color: var(--praxeti);
        padding: 60px;
        display: flex;
        flex-direction: column;
        justify-content: center;
      }

      /* Language Switcher */
      .lang-switcher {
        position: absolute;
        top: 25px;
        right: 25px;
        z-index: 10;
      }
      .lang-capsule {
        background: rgba(255, 255, 255, 0.15);
        backdrop-filter: blur(5px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 50px;
        padding: 6px 15px;
        display: flex;
        align-items: center;
        gap: 8px;
        font-weight: 700;
        font-size: 0.75rem;
      }
      .lang-btn {
        border: none;
        background: none;
        opacity: 0.5;
        cursor: pointer;
        transition: 0.3s;
        padding: 0;
        color: white;
        font-weight: 700;
      }
      .lang-btn:hover {
        opacity: 0.8;
      }
      .lang-btn.active {
        opacity: 1;
        color: var(--lime);
        transform: scale(1.1);
      }

      .form-label-custom {
        font-weight: 700;
        font-size: 0.9rem;
        color: var(--midnight);
        margin-bottom: 8px;
        display: block;
        letter-spacing: -0.3px;
      }

      .input-modern {
        width: 100%;
        padding: 18px;
        background-color: #fff;
        border: 2px solid #e2e8f0;
        border-radius: 12px;
        font-size: 1rem;
        color: var(--midnight);
        font-weight: 600;
        transition: all 0.3s ease;
      }

      .input-modern:focus {
        border-color: var(--lime);
        box-shadow: 0 8px 20px rgba(219, 230, 76, 0.15);
        outline: none;
        transform: translateY(-2px);
      }

      .btn-lime {
        background-color: var(--lime);
        color: var(--midnight);
        width: 100%;
        padding: 20px;
        border-radius: 12px;
        border: none;
        font-weight: 800;
        font-size: 1.1rem;
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 10px;
        cursor: pointer;
        box-shadow: 0 10px 20px rgba(219, 230, 76, 0.3);
        transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      }

      .btn-lime:hover {
        transform: translateY(-4px) scale(1.02);
        box-shadow: 0 20px 30px rgba(219, 230, 76, 0.4);
        background-color: #e4ee5e;
      }

      .check-container {
        display: flex;
        align-items: center;
        gap: 12px;
        cursor: pointer;
        margin-top: 10px;
      }
      .custom-check {
        width: 24px;
        height: 24px;
        border: 2px solid #cbd5e1;
        border-radius: 6px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: 0.2s;
        background: white;
      }
      input[type="checkbox"]:checked + .custom-check {
        background: var(--midnight);
        border-color: var(--midnight);
      }
      input[type="checkbox"]:checked + .custom-check::after {
        content: "✓";
        color: var(--lime);
        font-weight: 900;
        font-size: 14px;
      }

      /* Radio button untuk KTP/Passport */
      .radio-group {
        display: flex;
        gap: 20px;
        margin-bottom: 15px;
      }
      .radio-option {
        display: flex;
        align-items: center;
        gap: 8px;
        cursor: pointer;
      }
      .radio-circle {
        width: 20px;
        height: 20px;
        border-radius: 50%;
        border: 2px solid #cbd5e1;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
      }
      .radio-circle::after {
        content: '';
        width: 10px;
        height: 10px;
        border-radius: 50%;
        background: var(--midnight);
        transform: scale(0);
        transition: transform 0.3s ease;
      }
      input[type="radio"]:checked + .radio-circle {
        border-color: var(--midnight);
      }
      input[type="radio"]:checked + .radio-circle::after {
        transform: scale(1);
      }

      /* --- TICKET WEB VIEW --- */
      #ticketScreen {
        display: none;
        text-align: center;
      }

      .ticket-card {
        background: white;
        border: 2px dashed #cbd5e1;
        border-radius: 16px;
        padding: 30px;
        margin: 30px 0;
        position: relative;
        overflow: hidden;
      }

      .ticket-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 6px;
        background: repeating-linear-gradient(
          45deg,
          var(--midnight),
          var(--midnight) 10px,
          var(--lime) 10px,
          var(--lime) 20px
        );
      }

      .code-display {
        font-family: "JetBrains Mono", monospace;
        font-size: 3rem;
        font-weight: 800;
        color: var(--midnight);
        letter-spacing: -2px;
        margin: 15px 0;
      }

      /* ==================================================================
           PRINT SYSTEM
           ================================================================== */
      #print-overlay {
        display: none;
      }

      @media print {
        body {
          visibility: hidden !important;
          background: white !important;
        }
        .main-card {
          display: none !important;
        }

        #print-overlay {
          visibility: visible !important;
          display: block !important;
          position: absolute !important;
          top: 0 !important;
          left: 0 !important;
          width: 100% !important;
          height: 100% !important;
          background: white !important;
          color: black !important;
          padding: 40px !important;
          z-index: 999999999 !important;
        }

        /* Print Header */
        .p-head {
          border-bottom: 3px solid #000;
          padding-bottom: 15px;
          margin-bottom: 25px;
          display: flex;
          justify-content: space-between;
        }
        .p-title {
          font-size: 20pt;
          font-weight: 900;
          text-transform: uppercase;
        }

        /* Print Body */
        .p-grid {
          display: grid;
          grid-template-columns: 180px 1fr;
          border-bottom: 1px solid #ddd;
          padding: 10px 0;
        }
        .p-label {
          font-weight: bold;
          text-transform: uppercase;
          font-size: 9pt;
          color: #555;
          letter-spacing: 1px;
        }
        .p-value {
          font-weight: bold;
          font-size: 11pt;
          color: #000;
        }

        .p-box {
          border: 4px solid #000;
          padding: 15px;
          text-align: center;
          margin: 30px 0;
          border-radius: 8px;
        }
        .p-bigcode {
          font-family: monospace;
          font-size: 35pt;
          font-weight: 900;
          letter-spacing: 2px;
        }

        .signature-area {
          display: flex;
          justify-content: space-between;
          margin-top: 50px;
          padding-top: 20px;
          page-break-inside: avoid;
        }

        .sig-box {
          width: 45%;
          text-align: center;
        }

        .sig-title {
          font-size: 10pt;
          font-weight: bold;
          text-transform: uppercase;
          margin-bottom: 120px;
        }

        .sig-line {
          border-top: 1px solid #000;
          padding-top: 10px;
          font-size: 11pt;
          font-weight: bold;
        }

        .p-footer {
          text-align: center;
          margin-top: 40px;
          font-size: 8pt;
          color: #666;
          border-top: 1px dashed #999;
          padding-top: 10px;
        }
      }

      @media (max-width: 991px) {
        .main-card {
          flex-direction: column;
        }
        .left-panel {
          padding: 40px;
          min-height: 280px;
        }
        .item-title {
          font-size: 2.5rem;
        }
        .right-panel {
          padding: 30px;
        }
        .radio-group {
          flex-direction: column;
          gap: 10px;
        }
        .lang-switcher {
          top: 15px;
          right: 15px;
        }
      }
    </style>
  </head>
  <body>
    <!-- Language Switcher -->
    <div class="lang-switcher">
      <div class="lang-capsule">
        <button class="lang-btn active" onclick="switchLang('id')">
          ID
        </button>
        <span style="opacity: 0.1">|</span>
        <button class="lang-btn" onclick="switchLang('en')">EN</button>
      </div>
    </div>

    <div class="main-card">
      <div class="col-lg-5 left-panel">
        <div class="decoration-circle"></div>
        <div style="position: relative; z-index: 2">
          <a
            href="javascript:history.back()"
            class="text-white text-decoration-none d-flex align-items-center mb-4"
            style="opacity: 0.8; font-weight: 600"
          >
            <i class="ri-arrow-left-line me-2"></i> 
            <span class="lang-target" data-id="KEMBALI" data-en="BACK">KEMBALI</span>
          </a>
          <div class="system-badge">
            <div class="pulse-dot"></div>
            <span class="lang-target" data-id="SYSTEM ONLINE" data-en="SYSTEM ONLINE">SYSTEM ONLINE</span>
          </div>
          <h1 class="item-title" id="displayItemName">Item Name</h1>
        </div>
        <div class="secure-info" style="position: relative; z-index: 2">
          <span class="lang-target" data-id="Sistem enkripsi aktif. Pastikan data sesuai KTP untuk validasi manual." data-en="Encryption system active. Ensure data matches ID for manual validation.">
            Sistem enkripsi aktif. Pastikan data sesuai KTP untuk validasi manual.
          </span>
          <div class="mt-3 opacity-50 font-monospace small">
            SECURE_ID: 884-X • V.2.0
          </div>
        </div>
      </div>

      <div class="col-lg-7 right-panel">
        <div id="formContainer">
          <div class="mb-4">
            <h2 style="font-weight: 800; color: var(--midnight); margin-bottom: 5px;">
              <span class="lang-target" data-id="Verifikasi Pemilik" data-en="Owner Verification">Verifikasi Pemilik</span>
            </h2>
            <p style="color: var(--slate)">
              <span class="lang-target" data-id="Lengkapi detail di bawah untuk klaim barang." data-en="Complete the details below to claim your item.">
                Lengkapi detail di bawah untuk klaim barang.
              </span>
            </p>
          </div>
          <form id="claimForm">
            <input type="hidden" id="itemName" />
            
            <!-- Row 1: Nama Lengkap & Nomor WhatsApp -->
            <div class="row g-3 mb-3">
              <div class="col-md-6">
                <label class="form-label-custom">
                  <span class="lang-target" data-id="Nama Lengkap (KTP/Paspor)" data-en="Full Name (ID Card/Passport)">Nama Lengkap (KTP/Paspor)</span>
                </label>
                <input
                  type="text"
                  id="nama"
                  class="input-modern"
                  placeholder="ex : Finesya Adira"
                  required
                />
              </div>
              <div class="col-md-6">
                <label class="form-label-custom">
                  <span class="lang-target" data-id="Nomor WhatsApp" data-en="WhatsApp Number">Nomor WhatsApp</span>
                </label>
                <input
                  type="tel"
                  id="kontak"
                  class="input-modern"
                  placeholder="0812..."
                  required
                />
              </div>
            </div>

            <!-- Row 2: Jenis Identitas & No. Identitas -->
            <div class="mb-3">
              <label class="form-label-custom">
                <span class="lang-target" data-id="Jenis Identitas" data-en="ID Type">Jenis Identitas</span>
              </label>
              <div class="radio-group">
                <label class="radio-option">
                  <input type="radio" name="idType" value="ktp" checked hidden />
                  <div class="radio-circle"></div>
                  <span class="lang-target" data-id="KTP/SIM" data-en="ID Card/Driver License">KTP/SIM</span>
                </label>
                <label class="radio-option">
                  <input type="radio" name="idType" value="paspor" hidden />
                  <div class="radio-circle"></div>
                  <span class="lang-target" data-id="Paspor (WNA)" data-en="Passport (Foreigner)">Paspor (WNA)</span>
                </label>
              </div>
            </div>
            
            <div class="mb-3">
              <label class="form-label-custom">
                <span class="lang-target" data-id="No. Identitas" data-en="ID Number">No. Identitas</span>
              </label>
              <input
                type="text"
                id="noIdentitas"
                class="input-modern"
                placeholder="Ketik nomor KTP atau Paspor..."
                required
              />
              <small class="text-muted d-block mt-1">
                <span class="lang-target" data-id="Wajib sesuai dokumen asli" data-en="Must match original document">Wajib sesuai dokumen asli</span>
              </small>
            </div>

            <!-- Row 3: Alamat sesuai Identitas -->
            <div class="mb-4">
              <label class="form-label-custom">
                <span class="lang-target" data-id="Alamat sesuai Identitas" data-en="Address as per ID">Alamat sesuai Identitas</span>
              </label>
              <textarea
                id="alamat"
                class="input-modern"
                rows="3"
                placeholder="Tulis alamat lengkap sesuai KTP/Paspor..."
                required
              ></textarea>
            </div>

            <!-- Row 4: Ciri Unik Barang -->
            <div class="mb-4">
              <label class="form-label-custom">
                <span class="lang-target" data-id="Ciri Unik Barang (Detail)" data-en="Unique Item Features (Details)">Ciri Unik Barang (Detail)</span>
              </label>
              <textarea
                id="bukti"
                class="input-modern"
                rows="3"
                placeholder="Sebutkan stiker, goresan, warna, ukuran, atau ciri khusus lainnya..."
                required
              ></textarea>
            </div>

            <!-- Checkbox Pernyataan -->
            <label class="check-container mb-4">
              <input type="checkbox" id="checkJujur" hidden required />
              <div class="custom-check"></div>
              <span class="text-muted small fw-bold">
                <span class="lang-target" data-id="Saya menjamin kebenaran dan keaslian seluruh data yang saya sampaikan, serta bersedia bertanggung jawab penuh atas data tersebut." data-en="I guarantee the truthfulness and authenticity of all data I provide, and am fully responsible for the submitted data.">
                  Saya menjamin kebenaran dan keaslian seluruh data yang saya sampaikan, serta bersedia bertanggung jawab penuh atas data tersebut.
                </span>
              </span>
            </label>

            <!-- Submit Button -->
            <button type="submit" id="submitBtn" class="btn-lime">
              <span class="lang-target" data-id="GENERATE TICKET" data-en="GENERATE TICKET">GENERATE TICKET</span>
              <i class="ri-arrow-right-line"></i>
            </button>
          </form>
        </div>

        <!-- Ticket Screen -->
        <div id="ticketScreen">
          <div style="font-size: 4rem; color: #10b981; line-height: 1">
            <i class="ri-checkbox-circle-fill"></i>
          </div>
          <h3 class="fw-bold mt-3" style="color: var(--midnight)">
            <span class="lang-target" data-id="Permintaan Terkirim!" data-en="Request Submitted!">Permintaan Terkirim!</span>
          </h3>
          <p class="text-muted">
            <span class="lang-target" data-id="Simpan tiket ini dan tunjukkan ke petugas." data-en="Save this ticket and show it to our staff.">
              Simpan tiket ini dan tunjukkan ke petugas.
            </span>
          </p>
          <div class="ticket-card">
            <small class="text-uppercase text-muted fw-bold ls-1">
              <span class="lang-target" data-id="KODE PENGAMBILAN" data-en="PICKUP CODE">KODE PENGAMBILAN</span>
            </small>
            <div class="code-display" id="webCode">...</div>
            <div class="d-flex justify-content-between pt-3 border-top mt-2">
              <div class="text-start">
                <small class="text-muted d-block" style="font-size: 0.7rem">
                  <span class="lang-target" data-id="PEMILIK" data-en="OWNER">PEMILIK</span>
                </small>
                <strong id="webName" style="color: var(--midnight)">-</strong>
              </div>
              <div class="text-end">
                <small class="text-muted d-block" style="font-size: 0.7rem">
                  <span class="lang-target" data-id="BARANG" data-en="ITEM">BARANG</span>
                </small>
                <strong id="webItem" style="color: var(--midnight)">-</strong>
              </div>
            </div>
            <div class="text-start mt-3 pt-3 border-top">
              <small class="text-muted d-block" style="font-size: 0.7rem">
                <span class="lang-target" data-id="JENIS IDENTITAS" data-en="ID TYPE">JENIS IDENTITAS</span>
              </small>
              <strong id="webIdType" style="color: var(--midnight)">-</strong>
            </div>
          </div>
          <div class="d-grid gap-2">
            <button
              onclick="window.print()"
              class="btn-lime justify-content-center"
            >
              <i class="ri-printer-fill"></i>
              <span class="lang-target" data-id="CETAK / SIMPAN PDF" data-en="PRINT / SAVE PDF">CETAK / SIMPAN PDF</span>
            </button>
            <button
              onclick="location.reload()"
              class="btn btn-link text-muted"
              style="text-decoration: none"
            >
              <span class="lang-target" data-id="Kembali ke Beranda" data-en="Back to Home">Kembali ke Beranda</span>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Print Overlay -->
    <div id="print-overlay">
      <div class="p-head">
        <div class="p-title">RHAPSODY FIND</div>
        <div class="text-end">
          <small class="lang-target" data-id="TANGGAL" data-en="DATE">TANGGAL</small><br />
          <strong id="printDate">...</strong>
        </div>
      </div>

      <h2 style="margin-bottom: 30px" class="lang-target" data-id="BUKTI KLAIM BARANG" data-en="ITEM CLAIM PROOF">BUKTI KLAIM BARANG</h2>

      <div class="p-grid">
        <span class="p-label lang-target" data-id="NAMA PEMOHON" data-en="APPLICANT NAME">NAMA PEMOHON</span>
        <span class="p-value" id="printName">...</span>
      </div>
      <div class="p-grid">
        <span class="p-label lang-target" data-id="KONTAK" data-en="CONTACT">KONTAK</span>
        <span class="p-value" id="printContact">...</span>
      </div>
      <div class="p-grid">
        <span class="p-label lang-target" data-id="JENIS IDENTITAS" data-en="ID TYPE">JENIS IDENTITAS</span>
        <span class="p-value" id="printIdType">...</span>
      </div>
      <div class="p-grid">
        <span class="p-label lang-target" data-id="NO. IDENTITAS" data-en="ID NUMBER">NO. IDENTITAS</span>
        <span class="p-value" id="printNoIdentitas">...</span>
      </div>
      <div class="p-grid">
        <span class="p-label lang-target" data-id="ALAMAT" data-en="ADDRESS">ALAMAT</span>
        <span class="p-value" id="printAlamat">...</span>
      </div>
      <div class="p-grid">
        <span class="p-label lang-target" data-id="NAMA BARANG" data-en="ITEM NAME">NAMA BARANG</span>
        <span class="p-value" id="printItem">...</span>
      </div>

      <div style="margin-top: 20px; padding: 15px; border: 1px dashed #666">
        <span class="p-label lang-target" style="display: block; margin-bottom: 5px" data-id="DETAIL CIRI:" data-en="DETAIL FEATURES:">DETAIL CIRI:</span>
        <span id="printBukti" style="font-style: italic">...</span>
      </div>

      <div class="p-box">
        <div
          style="
            text-transform: uppercase;
            letter-spacing: 2px;
            font-size: 10pt;
            margin-bottom: 10px;
          "
          class="lang-target"
          data-id="Kode Verifikasi"
          data-en="Verification Code"
        >
          Kode Verifikasi
        </div>
        <div class="p-bigcode" id="printCode">...</div>
      </div>

      <div class="signature-area">
        <div class="sig-box">
          <div class="sig-title lang-target" data-id="Petugas Validasi" data-en="Validation Officer">Petugas Validasi</div>
          <div class="sig-line">( ___________________ )</div>
        </div>
        <div class="sig-box">
          <div class="sig-title lang-target" data-id="Penerima Barang" data-en="Item Recipient">Penerima Barang</div>
          <div class="sig-line">
            ( <span id="printNameSig">Nama Penerima</span> )
          </div>
        </div>
      </div>

      <div class="p-footer">
        <span class="lang-target" data-id="Harap membawa kartu identitas asli (KTP/Paspor) saat pengambilan." data-en="Please bring original ID card (ID/Passport) when picking up.">
          Harap membawa kartu identitas asli (KTP/Paspor) saat pengambilan.
        </span><br />
        © RhapsodyFind System - Secure Claim V.2.0
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script>
      // URL Web App Google Script
      const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyqayUDt6j8xnDoHaNz1mO91X3e3kndndDFANWTKt_fwbx8NtNySaiw0RTHWeT8i0dZ/exec";

      // Language switching function
      let currentLang = 'id';

      function switchLang(lang) {
        currentLang = lang;
        
        // Update button states
        document.querySelectorAll('.lang-btn').forEach(btn => {
          btn.classList.remove('active');
        });
        event.currentTarget.classList.add('active');

        // Update all text elements with data attributes
        document.querySelectorAll('.lang-target').forEach(el => {
          const text = el.getAttribute(`data-${lang}`);
          if (text) el.innerText = text;
        });

        // Update form placeholders based on language
        updatePlaceholders(lang);
      }

      function updatePlaceholders(lang) {
        const namaInput = document.getElementById('nama');
        const kontakInput = document.getElementById('kontak');
        const noIdentitasInput = document.getElementById('noIdentitas');
        const alamatTextarea = document.getElementById('alamat');
        const buktiTextarea = document.getElementById('bukti');
        
        if (lang === 'id') {
          namaInput.placeholder = "contoh : Finesya Adira";
          kontakInput.placeholder = "0812...";
          noIdentitasInput.placeholder = "Ketik nomor KTP atau Paspor...";
          alamatTextarea.placeholder = "Tulis alamat lengkap sesuai KTP/Paspor...";
          buktiTextarea.placeholder = "Sebutkan stiker, goresan, warna, ukuran, atau ciri khusus lainnya...";
        } else {
          namaInput.placeholder = "ex : Finesya Adira";
          kontakInput.placeholder = "+62...";
          noIdentitasInput.placeholder = "Enter ID card or passport number...";
          alamatTextarea.placeholder = "Write full address as per ID card/passport...";
          buktiTextarea.placeholder = "Mention stickers, scratches, colors, sizes, or other unique features...";
        }

        // Update radio button labels
        const idType = document.querySelector('input[name="idType"]:checked').value;
        if (idType === 'ktp') {
          noIdentitasInput.placeholder = lang === 'id' ? "Ketik 16 digit NIK atau No SIM..." : "Enter 16-digit NIK or Driver License Number...";
        } else {
          noIdentitasInput.placeholder = lang === 'id' ? "Ketik nomor paspor..." : "Enter passport number...";
        }
      }

      // 1. Ambil Nama Barang dari URL
      document.addEventListener("DOMContentLoaded", function () {
        const params = new URLSearchParams(window.location.search);
        const item = params.get("item");
        if (item) {
          const cleanName = decodeURIComponent(item);
          document.getElementById("itemName").value = cleanName;
          document.getElementById("displayItemName").innerText = cleanName;
        }

        // Radio button toggle placeholder
        const ktpRadio = document.querySelector('input[value="ktp"]');
        const pasporRadio = document.querySelector('input[value="paspor"]');
        const noIdentitasInput = document.getElementById("noIdentitas");

        function updatePlaceholderByRadio() {
          if (ktpRadio.checked) {
            noIdentitasInput.placeholder = currentLang === 'id' ? "Ketik 16 digit NIK atau No SIM..." : "Enter 16-digit NIK or Driver License Number...";
          } else {
            noIdentitasInput.placeholder = currentLang === 'id' ? "Ketik nomor paspor..." : "Enter passport number...";
          }
        }

        ktpRadio.addEventListener("change", updatePlaceholderByRadio);
        pasporRadio.addEventListener("change", updatePlaceholderByRadio);
        updatePlaceholderByRadio(); // Initial call
      });

      // 2. Handle Submit Form - UPDATE GOOGLE SHEETS
      document
        .getElementById("claimForm")
        .addEventListener("submit", async function (e) {
          e.preventDefault();

          const btn = document.getElementById("submitBtn");
          const originalBtnText = btn.innerHTML;
          btn.innerHTML = `<span class="spinner-border spinner-border-sm me-2"></span> <span class="lang-target" data-id="MENGIRIM..." data-en="SUBMITTING...">MENGIRIM...</span>`;
          btn.style.opacity = "0.8";
          btn.disabled = true;

          // Generate random code
          const code = "RF-" + Math.random().toString(36).substring(2, 7).toUpperCase();
          
          // Get form values
          const nama = document.getElementById("nama").value.trim();
          const kontak = document.getElementById("kontak").value.trim();
          const noIdentitas = document.getElementById("noIdentitas").value.trim();
          const alamat = document.getElementById("alamat").value.trim();
          const item = document.getElementById("itemName").value.trim();
          const bukti = document.getElementById("bukti").value.trim();
          const idType = document.querySelector('input[name="idType"]:checked').value;
          const now = new Date().toLocaleString("id-ID");
          const idTypeText = idType === "ktp" ? 
            (currentLang === 'id' ? "KTP/SIM" : "ID Card/Driver License") : 
            (currentLang === 'id' ? "Paspor" : "Passport");

          // Data untuk dikirim ke Google Sheets
          const formData = {
            nama: nama,
            kontak: kontak,
            jenisID: idTypeText,
            noIdentitas: noIdentitas,
            alamat: alamat,
            barang: item,
            bukti: bukti,
            kodeTicket: code,
            timestamp: now
          };

          try {
            // Kirim data ke Google Sheets via fetch API
            const response = await fetch(GOOGLE_SCRIPT_URL, {
              method: 'POST',
              mode: 'no-cors', // Penting untuk Google Apps Script
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify(formData)
            });
            
            // Populate Web Ticket
            document.getElementById("webCode").innerText = code;
            document.getElementById("webName").innerText = nama;
            document.getElementById("webItem").innerText = item;
            document.getElementById("webIdType").innerText = idTypeText;

            // Populate Print Preview
            document.getElementById("printCode").innerText = code;
            document.getElementById("printName").innerText = nama;
            document.getElementById("printContact").innerText = kontak;
            document.getElementById("printIdType").innerText = idTypeText;
            document.getElementById("printNoIdentitas").innerText = noIdentitas;
            document.getElementById("printAlamat").innerText = alamat;
            document.getElementById("printItem").innerText = item;
            document.getElementById("printBukti").innerText = bukti;
            document.getElementById("printDate").innerText = now;
            document.getElementById("printNameSig").innerText = nama;

            // Apply current language to print overlay
            document.querySelectorAll('#print-overlay .lang-target').forEach(el => {
              const text = el.getAttribute(`data-${currentLang}`);
              if (text) el.innerText = text;
            });

            // Transisi tampilan
            document.getElementById("formContainer").style.display = "none";
            document.getElementById("ticketScreen").style.display = "block";

            // Animasi muncul
            document.getElementById("ticketScreen").animate(
              [
                { opacity: 0, transform: "scale(0.9)" },
                { opacity: 1, transform: "scale(1)" },
              ],
              { duration: 400, easing: "cubic-bezier(0.18, 0.89, 0.32, 1.28)" }
            );

            // Confetti effect
            confetti({
              particleCount: 150,
              spread: 80,
              origin: { y: 0.6 },
              colors: ["#001F3F", "#DBE64C", "#F6F7ED"],
            });

          } catch (error) {
            console.error("Error submitting to Google Sheets:", error);
            
            // Tampilkan alert warning
            alert(currentLang === 'id' 
              ? "⚠️ Data berhasil dibuat secara lokal, tetapi gagal disimpan ke server. Harap screenshot tiket ini." 
              : "⚠️ Data created locally but failed to save to server. Please screenshot this ticket.");
            
            // Lanjutkan dengan menampilkan ticket
            document.getElementById("webCode").innerText = code;
            document.getElementById("webName").innerText = nama;
            document.getElementById("webItem").innerText = item;
            document.getElementById("webIdType").innerText = idTypeText;

            document.getElementById("printCode").innerText = code;
            document.getElementById("printName").innerText = nama;
            document.getElementById("printContact").innerText = kontak;
            document.getElementById("printIdType").innerText = idTypeText;
            document.getElementById("printNoIdentitas").innerText = noIdentitas;
            document.getElementById("printAlamat").innerText = alamat;
            document.getElementById("printItem").innerText = item;
            document.getElementById("printBukti").innerText = bukti;
            document.getElementById("printDate").innerText = now;
            document.getElementById("printNameSig").innerText = nama;

            // Apply current language to print overlay
            document.querySelectorAll('#print-overlay .lang-target').forEach(el => {
              const text = el.getAttribute(`data-${currentLang}`);
              if (text) el.innerText = text;
            });

            document.getElementById("formContainer").style.display = "none";
            document.getElementById("ticketScreen").style.display = "block";

            // Confetti tetap muncul meski error
            confetti({
              particleCount: 80,
              spread: 60,
              origin: { y: 0.6 },
              colors: ["#001F3F", "#DBE64C"],
            });
          } finally {
            // Reset button state
            btn.disabled = false;
            btn.style.opacity = "1";
            btn.innerHTML = originalBtnText;
          }
        });
    </script>
  </body>
</html>